D:\projects\a\doctr\references\recognition\train_pytorch.py:115: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
  0%|                                                                                                                                                                                                         | 0/3281 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:128: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
D:\projects\a\.venv\lib\site-packages\torch\optim\lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Training loss: 2.05366 | LR: 0.000993844: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [09:11<00:00,  5.95it/s]
Epoch 1/20 - Training loss: 2.80839 | LR: 0.000993844
  0%|                                                                                                                                                                                                          | 0/847 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:170: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Validation loss: 1.68777: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:38<00:00,  3.88it/s]
Validation loss decreased inf --> 1.77673: saving state...
Epoch 1/20 - Validation loss: 1.77673 (Exact: 4.83% | Partial: 5.02%)
Training loss: 0.972715 | LR: 0.000975528: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:00<00:00,  7.80it/s]
Epoch 2/20 - Training loss: 1.52875 | LR: 0.000975528
Validation loss: 1.09463: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:03<00:00,  4.62it/s]
Validation loss decreased 1.77673 --> 1.0891: saving state...
Epoch 2/20 - Validation loss: 1.0891 (Exact: 18.73% | Partial: 19.17%)
Training loss: 0.920506 | LR: 0.000945503: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:57<00:00,  6.88it/s]
Epoch 3/20 - Training loss: 1.08337 | LR: 0.000945503
Validation loss: 0.783817: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:33<00:00,  3.97it/s]
Validation loss decreased 1.0891 --> 0.830241: saving state...
Epoch 3/20 - Validation loss: 0.830241 (Exact: 28.43% | Partial: 29.21%)
Training loss: 0.637115 | LR: 0.000904509: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:54<00:00,  6.91it/s]
Epoch 4/20 - Training loss: 0.865931 | LR: 0.000904509
Validation loss: 0.621238: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:08<00:00,  4.50it/s]
Validation loss decreased 0.830241 --> 0.668301: saving state...
Epoch 4/20 - Validation loss: 0.668301 (Exact: 37.00% | Partial: 37.91%)
Training loss: 0.509295 | LR: 0.000853554: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:50<00:00,  6.97it/s]
Epoch 5/20 - Training loss: 0.727491 | LR: 0.000853554
Validation loss: 0.573954: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:21<00:00,  4.20it/s]
Validation loss decreased 0.668301 --> 0.579751: saving state...
Epoch 5/20 - Validation loss: 0.579751 (Exact: 43.85% | Partial: 44.77%)
Training loss: 0.386434 | LR: 0.000793893: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:45<00:00,  7.04it/s]
Epoch 6/20 - Training loss: 0.627008 | LR: 0.000793893
Validation loss: 0.361949: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:20<00:00,  4.22it/s]
Validation loss decreased 0.579751 --> 0.524768: saving state...
Epoch 6/20 - Validation loss: 0.524768 (Exact: 47.43% | Partial: 48.24%)
Training loss: 0.501661 | LR: 0.000726996: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [09:21<00:00,  5.84it/s]
Epoch 7/20 - Training loss: 0.553927 | LR: 0.000726996
Validation loss: 0.468042: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:33<00:00,  3.96it/s]
Validation loss decreased 0.524768 --> 0.495068: saving state...
Epoch 7/20 - Validation loss: 0.495068 (Exact: 49.03% | Partial: 49.94%)
Training loss: 1.00873 | LR: 0.00065451: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:46<00:00,  7.03it/s]
Epoch 8/20 - Training loss: 0.491122 | LR: 0.00065451
Validation loss: 0.419227: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:16<00:00,  4.31it/s]
Validation loss decreased 0.495068 --> 0.457329: saving state...
Epoch 8/20 - Validation loss: 0.457329 (Exact: 52.95% | Partial: 53.78%)
Training loss: 0.201812 | LR: 0.000578219: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:03<00:00,  6.78it/s]
Epoch 9/20 - Training loss: 0.443053 | LR: 0.000578219
Validation loss: 0.326953: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:12<00:00,  4.40it/s]
Validation loss decreased 0.457329 --> 0.427096: saving state...
Epoch 9/20 - Validation loss: 0.427096 (Exact: 55.25% | Partial: 56.12%)
Training loss: 0.326245 | LR: 0.000500002: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:14<00:00,  6.64it/s]
Epoch 10/20 - Training loss: 0.393813 | LR: 0.000500002
Validation loss: 0.435818: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:14<00:00,  4.37it/s]
Validation loss decreased 0.427096 --> 0.404791: saving state...
Epoch 10/20 - Validation loss: 0.404791 (Exact: 56.98% | Partial: 57.81%)
Training loss: 0.314613 | LR: 0.000421785: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:48<00:00,  7.01it/s]
Epoch 11/20 - Training loss: 0.355948 | LR: 0.000421785
Validation loss: 0.3087: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:20<00:00,  4.23it/s]
Validation loss decreased 0.404791 --> 0.393289: saving state...
Epoch 11/20 - Validation loss: 0.393289 (Exact: 58.67% | Partial: 59.49%)
Training loss: 1.0005 | LR: 0.000345494: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:33<00:00,  6.38it/s]
Epoch 12/20 - Training loss: 0.316264 | LR: 0.000345494
Validation loss: 0.301872: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:25<00:00,  4.13it/s]
Validation loss decreased 0.393289 --> 0.388647: saving state...
Epoch 12/20 - Validation loss: 0.388647 (Exact: 59.22% | Partial: 60.11%)
Training loss: 0.214003 | LR: 0.000273008: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:56<00:00,  6.11it/s]
Epoch 13/20 - Training loss: 0.285765 | LR: 0.000273008
Validation loss: 0.269278: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:29<00:00,  4.04it/s]
Validation loss decreased 0.388647 --> 0.374235: saving state...
Epoch 13/20 - Validation loss: 0.374235 (Exact: 60.85% | Partial: 61.70%)
Training loss: 0.289475 | LR: 0.000206111: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:51<00:00,  6.96it/s]
Epoch 14/20 - Training loss: 0.261201 | LR: 0.000206111
Validation loss: 0.32522: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:39<00:00,  3.86it/s]
Validation loss decreased 0.374235 --> 0.368371: saving state...
Epoch 14/20 - Validation loss: 0.368371 (Exact: 62.09% | Partial: 62.85%)
Training loss: 0.357238 | LR: 0.00014645: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:04<00:00,  6.77it/s]
Epoch 15/20 - Training loss: 0.238124 | LR: 0.00014645
Validation loss: 0.249067: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:16<00:00,  4.31it/s]
Validation loss decreased 0.368371 --> 0.367138: saving state...
Epoch 15/20 - Validation loss: 0.367138 (Exact: 62.15% | Partial: 62.97%)
Training loss: 0.284874 | LR: 9.54951e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:59<00:00,  6.84it/s]
Epoch 16/20 - Training loss: 0.222199 | LR: 9.54951e-05
Validation loss: 0.265366: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:34<00:00,  3.94it/s]
Validation loss decreased 0.367138 --> 0.357005: saving state...
Epoch 16/20 - Validation loss: 0.357005 (Exact: 62.75% | Partial: 63.58%)
Training loss: 0.223313 | LR: 5.45005e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:06<00:00,  6.74it/s]
Epoch 17/20 - Training loss: 0.206983 | LR: 5.45005e-05
Validation loss: 0.287488: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:19<00:00,  4.25it/s]
Epoch 17/20 - Validation loss: 0.359966 (Exact: 63.50% | Partial: 64.28%)
Training loss: 0.333668 | LR: 2.44756e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [08:42<00:00,  6.28it/s]
Epoch 18/20 - Training loss: 0.196916 | LR: 2.44756e-05
Validation loss: 0.271658: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:21<00:00,  4.20it/s]
Validation loss decreased 0.357005 --> 0.354878: saving state...
Epoch 18/20 - Validation loss: 0.354878 (Exact: 63.53% | Partial: 64.31%)
Training loss: 0.0840011 | LR: 6.15981e-06: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:29<00:00,  7.29it/s]
Epoch 19/20 - Training loss: 0.191432 | LR: 6.15981e-06
Validation loss: 0.260769: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:34<00:00,  3.95it/s]
Epoch 19/20 - Validation loss: 0.355066 (Exact: 63.76% | Partial: 64.55%)
Training loss: 0.108047 | LR: 4e-09: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3281/3281 [07:52<00:00,  6.94it/s]
Epoch 20/20 - Training loss: 0.191191 | LR: 4e-09
Validation loss: 0.254762: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 847/847 [03:15<00:00,  4.33it/s]
Validation loss decreased 0.354878 --> 0.353453: saving state...
Epoch 20/20 - Validation loss: 0.353453 (Exact: 63.72% | Partial: 64.51%)

wandb: Run summary:
wandb:     exact_match 0.63725
wandb:   learning_rate 0.0
wandb:   partial_match 0.64514
wandb:         step_lr 0.0
wandb:      train_loss 0.19119
wandb: train_loss_step 0.10805
wandb:        val_loss 0.35345
wandb:   val_loss_step 0.25476

