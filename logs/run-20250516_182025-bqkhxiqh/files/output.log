D:\projects\a\doctr\references\recognition\train_pytorch.py:115: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
  0%|                                                                                                                                                                                                         | 0/4060 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:128: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
D:\projects\a\.venv\lib\site-packages\torch\optim\lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Training loss: 1.57603 | LR: 0.000989074: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [12:48<00:00,  5.29it/s]
Epoch 1/15 - Training loss: 2.61499 | LR: 0.000989074
  0%|                                                                                                                                                                                                           | 0/68 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:170: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Validation loss: 2.35883: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:50<00:00,  1.63s/it]
Validation loss decreased inf --> 1.87011: saving state...
Epoch 1/15 - Validation loss: 1.87011 (Exact: 2.69% | Partial: 2.69%)
Training loss: 0.980169 | LR: 0.000956773: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [09:49<00:00,  6.89it/s]
Epoch 2/15 - Training loss: 1.3102 | LR: 0.000956773
Validation loss: 1.7294: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.30s/it]
Validation loss decreased 1.87011 --> 1.25512: saving state...
Epoch 2/15 - Validation loss: 1.25512 (Exact: 12.42% | Partial: 12.97%)
Training loss: 0.767571 | LR: 0.000904509: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [09:45<00:00,  6.94it/s]
Epoch 3/15 - Training loss: 0.918394 | LR: 0.000904509
Validation loss: 1.3141: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:41<00:00,  1.49s/it]
Validation loss decreased 1.25512 --> 0.980304: saving state...
Epoch 3/15 - Validation loss: 0.980304 (Exact: 18.26% | Partial: 19.28%)
Training loss: 0.814892 | LR: 0.000834566: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [08:21<00:00,  8.10it/s]
Epoch 4/15 - Training loss: 0.729666 | LR: 0.000834566
Validation loss: 1.46871: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:50<00:00,  1.62s/it]
Validation loss decreased 0.980304 --> 0.866708: saving state...
Epoch 4/15 - Validation loss: 0.866708 (Exact: 23.45% | Partial: 24.47%)
Training loss: 0.342904 | LR: 0.000750001: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [06:54<00:00,  9.79it/s]
Epoch 5/15 - Training loss: 0.615908 | LR: 0.000750001
Validation loss: 1.35494: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:27<00:00,  1.29s/it]
Validation loss decreased 0.866708 --> 0.795856: saving state...
Epoch 5/15 - Validation loss: 0.795856 (Exact: 27.06% | Partial: 28.08%)
Training loss: 0.294666 | LR: 0.00065451: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [06:12<00:00, 10.90it/s]
Epoch 6/15 - Training loss: 0.531377 | LR: 0.00065451
Validation loss: 1.27906: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:52<00:00,  1.66s/it]
Validation loss decreased 0.795856 --> 0.735438: saving state...
Epoch 6/15 - Validation loss: 0.735438 (Exact: 31.70% | Partial: 33.36%)
Training loss: 0.275834 | LR: 0.000552266: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [11:50<00:00,  5.71it/s]
Epoch 7/15 - Training loss: 0.464084 | LR: 0.000552266
Validation loss: 1.34556: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.29s/it]
Validation loss decreased 0.735438 --> 0.705346: saving state...
Epoch 7/15 - Validation loss: 0.705346 (Exact: 35.22% | Partial: 36.70%)
Training loss: 0.4911 | LR: 0.000447738: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [05:52<00:00, 11.51it/s]
Epoch 8/15 - Training loss: 0.408484 | LR: 0.000447738
Validation loss: 1.26995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.30s/it]
Validation loss decreased 0.705346 --> 0.678912: saving state...
Epoch 8/15 - Validation loss: 0.678912 (Exact: 36.70% | Partial: 38.28%)
Training loss: 0.10479 | LR: 0.000345494: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [04:01<00:00, 16.83it/s]
Epoch 9/15 - Training loss: 0.363223 | LR: 0.000345494
Validation loss: 1.36686: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.29s/it]
Validation loss decreased 0.678912 --> 0.63231: saving state...
Epoch 9/15 - Validation loss: 0.63231 (Exact: 39.76% | Partial: 41.24%)
Training loss: 0.163266 | LR: 0.000250003: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [04:22<00:00, 15.45it/s]
Epoch 10/15 - Training loss: 0.323207 | LR: 0.000250003
Validation loss: 1.17752: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.29s/it]
Validation loss decreased 0.63231 --> 0.613189: saving state...
Epoch 10/15 - Validation loss: 0.613189 (Exact: 40.96% | Partial: 42.91%)
Training loss: 0.442486 | LR: 0.000165438: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [03:48<00:00, 17.79it/s]
Epoch 11/15 - Training loss: 0.289951 | LR: 0.000165438
Validation loss: 1.22587: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.30s/it]
Validation loss decreased 0.613189 --> 0.61311: saving state...
Epoch 11/15 - Validation loss: 0.61311 (Exact: 41.52% | Partial: 43.00%)
Training loss: 0.104963 | LR: 9.54951e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [07:29<00:00,  9.03it/s]
Epoch 12/15 - Training loss: 0.261796 | LR: 9.54951e-05
Validation loss: 1.1573: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:40<00:00,  1.47s/it]
Validation loss decreased 0.61311 --> 0.59384: saving state...
Epoch 12/15 - Validation loss: 0.59384 (Exact: 43.93% | Partial: 45.41%)
Training loss: 0.0814752 | LR: 4.32311e-05: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [05:39<00:00, 11.96it/s]
Epoch 13/15 - Training loss: 0.244287 | LR: 4.32311e-05
Validation loss: 1.15198: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:27<00:00,  1.29s/it]
Validation loss decreased 0.59384 --> 0.587397: saving state...
Epoch 13/15 - Validation loss: 0.587397 (Exact: 42.91% | Partial: 44.76%)
Training loss: 0.476589 | LR: 1.09302e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [09:59<00:00,  6.77it/s]
Epoch 14/15 - Training loss: 0.235408 | LR: 1.09302e-05
Validation loss: 1.16841: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.30s/it]
Validation loss decreased 0.587397 --> 0.585795: saving state...
Epoch 14/15 - Validation loss: 0.585795 (Exact: 43.28% | Partial: 45.23%)
Training loss: 0.103884 | LR: 4e-09: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4060/4060 [03:51<00:00, 17.51it/s]
Epoch 15/15 - Training loss: 0.227732 | LR: 4e-09
Validation loss: 1.19128: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68/68 [01:28<00:00,  1.30s/it]
Epoch 15/15 - Validation loss: 0.589985 (Exact: 43.19% | Partial: 45.04%)

wandb: Run history:                                                                                                                                                                                                                     
wandb:     exact_match ▁▃▄▅▅▆▇▇▇▇█████
wandb:   learning_rate ██▇▇▆▆▅▄▃▃▂▂▁▁▁
wandb:   partial_match ▁▃▄▅▅▆▇▇▇██████
wandb:         step_lr ████████▇▇▇▇▆▆▆▅▅▅▄▄▄▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁
wandb:      train_loss █▄▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb: train_loss_step █▄▅▄▄▄▃▃▃▃▃▃▂▂▂▃▂▁▂▃▂▃▂▁▂▁▁▁▂▁▁▂▁▂▁▁▂▁▁▁
wandb:        val_loss █▅▃▃▂▂▂▂▁▁▁▁▁▁▁
wandb:   val_loss_step ▆▇▄▃▂▄█▂▃▃▂▂▃▇▁▃▂▂▃▂▁▅▇▁▂▂▂▂▁▁▁▁▂▃▂▃▂▆▃▂
wandb:
wandb: Run summary:
wandb:     exact_match 0.43188
wandb:   learning_rate 0.0
wandb:   partial_match 0.45042
wandb:         step_lr 0.0
wandb:      train_loss 0.22773
wandb: train_loss_step 0.10388
wandb:        val_loss 0.58999
wandb:   val_loss_step 1.19128

