D:\projects\a\doctr\references\recognition\train_pytorch.py:115: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
  0%|                                                                                                                                                                                                         | 0/3280 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:128: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
D:\projects\a\.venv\lib\site-packages\torch\optim\lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Training loss: 1.68778 | LR: 0.000991487: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [09:25<00:00,  5.80it/s]
Epoch 1/17 - Training loss: 2.73899 | LR: 0.000991487
  0%|                                                                                                                                                                                                         | 0/1235 [00:00<?, ?it/s]D:\projects\a\doctr\references\recognition\train_pytorch.py:170: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Validation loss: 2.03007: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:30<00:00,  4.56it/s]
Validation loss decreased inf --> 1.63981: saving state...
Epoch 1/17 - Validation loss: 1.63981 (Exact: 5.47% | Partial: 5.64%)
Training loss: 1.00457 | LR: 0.000966236: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:27<00:00,  7.33it/s]
Epoch 2/17 - Training loss: 1.46552 | LR: 0.000966236
Validation loss: 1.46424: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:51<00:00,  5.34it/s]
Validation loss decreased 1.63981 --> 1.02303: saving state...
Epoch 2/17 - Validation loss: 1.02303 (Exact: 20.62% | Partial: 21.44%)
Training loss: 1.12901 | LR: 0.000925109: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:11<00:00,  7.60it/s]
Epoch 3/17 - Training loss: 1.03839 | LR: 0.000925109
Validation loss: 1.30692: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:03<00:00,  5.06it/s]
Validation loss decreased 1.02303 --> 0.770366: saving state...
Epoch 3/17 - Validation loss: 0.770366 (Exact: 31.83% | Partial: 32.75%)
Training loss: 1.08458 | LR: 0.000869505: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:18<00:00,  8.68it/s]
Epoch 4/17 - Training loss: 0.82873 | LR: 0.000869505
Validation loss: 1.45784: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:57<00:00,  5.21it/s]
Validation loss decreased 0.770366 --> 0.659413: saving state...
Epoch 4/17 - Validation loss: 0.659413 (Exact: 37.99% | Partial: 39.01%)
Training loss: 0.429373 | LR: 0.000801318: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:02<00:00,  9.06it/s]
Epoch 5/17 - Training loss: 0.701667 | LR: 0.000801318
Validation loss: 1.15457: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:17<00:00,  4.79it/s]
Validation loss decreased 0.659413 --> 0.566768: saving state...
Epoch 5/17 - Validation loss: 0.566768 (Exact: 42.89% | Partial: 43.93%)
Training loss: 0.691548 | LR: 0.00072287: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [08:01<00:00,  6.82it/s]
Epoch 6/17 - Training loss: 0.615095 | LR: 0.00072287
Validation loss: 1.14208: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:59<00:00,  5.15it/s]
Validation loss decreased 0.566768 --> 0.510214: saving state...
Epoch 6/17 - Validation loss: 0.510214 (Exact: 47.96% | Partial: 48.99%)
Training loss: 0.405148 | LR: 0.000636833: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:44<00:00,  7.06it/s]
Epoch 7/17 - Training loss: 0.544527 | LR: 0.000636833
Validation loss: 1.01687: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:25<00:00,  4.65it/s]
Validation loss decreased 0.510214 --> 0.470237: saving state...
Epoch 7/17 - Validation loss: 0.470237 (Exact: 50.90% | Partial: 51.94%)
Training loss: 0.465576 | LR: 0.000546136: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:44<00:00,  7.06it/s]
Epoch 8/17 - Training loss: 0.482707 | LR: 0.000546136
Validation loss: 0.898634: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:05<00:00,  6.65it/s]
Validation loss decreased 0.470237 --> 0.454832: saving state...
Epoch 8/17 - Validation loss: 0.454832 (Exact: 52.73% | Partial: 53.74%)
Training loss: 0.514863 | LR: 0.000453868: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [05:53<00:00,  9.27it/s]
Epoch 9/17 - Training loss: 0.432344 | LR: 0.000453868
Validation loss: 0.863877: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:07<00:00,  4.98it/s]
Validation loss decreased 0.454832 --> 0.419369: saving state...
Epoch 9/17 - Validation loss: 0.419369 (Exact: 55.40% | Partial: 56.31%)
Training loss: 0.514994 | LR: 0.000363171: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [05:56<00:00,  9.20it/s]
Epoch 10/17 - Training loss: 0.384097 | LR: 0.000363171
Validation loss: 0.690866: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:03<00:00,  5.07it/s]
Validation loss decreased 0.419369 --> 0.407114: saving state...
Epoch 10/17 - Validation loss: 0.407114 (Exact: 56.40% | Partial: 57.39%)
Training loss: 0.496955 | LR: 0.000277134: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:15<00:00,  8.74it/s]
Epoch 11/17 - Training loss: 0.349323 | LR: 0.000277134
Validation loss: 0.818205: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:51<00:00,  5.34it/s]
Validation loss decreased 0.407114 --> 0.388205: saving state...
Epoch 11/17 - Validation loss: 0.388205 (Exact: 57.97% | Partial: 58.91%)
Training loss: 0.319151 | LR: 0.000198686: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:38<00:00,  7.15it/s]
Epoch 12/17 - Training loss: 0.317307 | LR: 0.000198686
Validation loss: 0.723142: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:02<00:00,  5.09it/s]
Validation loss decreased 0.388205 --> 0.377551: saving state...
Epoch 12/17 - Validation loss: 0.377551 (Exact: 59.33% | Partial: 60.24%)
Training loss: 0.289886 | LR: 0.000130499: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [07:41<00:00,  7.10it/s]
Epoch 13/17 - Training loss: 0.285962 | LR: 0.000130499
Validation loss: 0.804775: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:25<00:00,  4.65it/s]
Validation loss decreased 0.377551 --> 0.372036: saving state...
Epoch 13/17 - Validation loss: 0.372036 (Exact: 60.09% | Partial: 60.99%)
Training loss: 0.265481 | LR: 7.48951e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:46<00:00,  8.08it/s]
Epoch 14/17 - Training loss: 0.266868 | LR: 7.48951e-05
Validation loss: 0.687491: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:02<00:00,  5.09it/s]
Validation loss decreased 0.372036 --> 0.366874: saving state...
Epoch 14/17 - Validation loss: 0.366874 (Exact: 60.73% | Partial: 61.62%)
Training loss: 0.199389 | LR: 3.37678e-05: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:35<00:00,  8.29it/s]
Epoch 15/17 - Training loss: 0.251607 | LR: 3.37678e-05
Validation loss: 0.722111: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:29<00:00,  5.89it/s]
Validation loss decreased 0.366874 --> 0.364311: saving state...
Epoch 15/17 - Validation loss: 0.364311 (Exact: 61.33% | Partial: 62.18%)
Training loss: 0.311812 | LR: 8.51742e-06: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [06:20<00:00,  8.63it/s]
Epoch 16/17 - Training loss: 0.246031 | LR: 8.51742e-06
Validation loss: 0.740255: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [04:08<00:00,  4.97it/s]
Validation loss decreased 0.364311 --> 0.363123: saving state...
Epoch 16/17 - Validation loss: 0.363123 (Exact: 61.37% | Partial: 62.26%)
Training loss: 0.179049 | LR: 4e-09: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3280/3280 [08:00<00:00,  6.82it/s]
Epoch 17/17 - Training loss: 0.241542 | LR: 4e-09
Validation loss: 0.720805: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1235/1235 [03:54<00:00,  5.27it/s]
Validation loss decreased 0.363123 --> 0.362758: saving state...
Epoch 17/17 - Validation loss: 0.362758 (Exact: 61.38% | Partial: 62.23%)
wandb: Run history:
wandb:     exact_match ▁▃▄▅▆▆▇▇▇▇███████
wandb:   learning_rate ███▇▇▆▅▅▄▄▃▂▂▂▁▁▁
wandb:   partial_match ▁▃▄▅▆▆▇▇▇▇███████
wandb:         step_lr █████▇▇▇▇▆▆▆▆▅▅▅▅▅▅▄▄▄▄▄▄▃▃▃▂▂▂▂▂▂▁▁▁▁▁▁
wandb:      train_loss █▄▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb: train_loss_step █▇▇▄▄▃▃▃▃▂▃▂▃▂▂▁▃▂▂▂▂▂▂▂▂▁▁▂▁▁▁▂▂▁▁▁▁▁▁▁
wandb:        val_loss █▅▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁
wandb:   val_loss_step █▇▆▃▄▃▅▂▃▃▂▂▂▃▃▃▃▁▂▂▃▃▂▂▂▂▂▂▂▁▂▂▂▂▂▃▂▃▁▁
wandb:
wandb: Run summary:
wandb:     exact_match 0.6138
wandb:   learning_rate 0.0
wandb:   partial_match 0.62235
wandb:         step_lr 0.0
wandb:      train_loss 0.24154
wandb: train_loss_step 0.17905
wandb:        val_loss 0.36276
wandb:   val_loss_step 0.72081

